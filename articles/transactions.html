<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="actxps">
<title>Transaction studies • actxps</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transaction studies">
<meta property="og:description" content="actxps">
<meta property="og:image" content="https://mattheaphy.github.io/actxps/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">actxps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/actxps.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exposures.html">Exposure calculations</a>
    <a class="dropdown-item" href="../articles/exp_summary.html">Experience summaries</a>
    <a class="dropdown-item" href="../articles/transactions.html">Transaction studies</a>
    <a class="dropdown-item" href="../articles/misc.html">Other functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattheaphy/actxps/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Transaction studies</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mattheaphy/actxps/blob/HEAD/vignettes/transactions.Rmd" class="external-link"><code>vignettes/transactions.Rmd</code></a></small>
      <div class="d-none name"><code>transactions.Rmd</code></div>
    </div>

    
    
<p>This article walks through an example of creating a
<strong>transaction study</strong> using the actxps package. Unlike a
termination study, transaction studies track events that can occur
multiple times over the life of a policy. Often, transactions are
expected to reoccur; for example, the utilization of a guaranteed income
stream.</p>
<p>Key questions to answer in a transaction study are:</p>
<ul>
<li>What types of transactions occurred?</li>
<li>What is the count, amount, and average size of observed
transactions?</li>
<li>What percentage of policies have transactions each exposure
period?</li>
<li>How do transactions compare to expectations?</li>
<li>What is the rate of transaction amounts as a percentage of another
value?</li>
</ul>
<p>The example below walks through preparing data by adding transaction
information to a data frame with exposure-level records using the
<code><a href="../reference/add_transactions.html">add_transactions()</a></code> function. Next, study results are
summarized using the <code><a href="../reference/trx_stats.html">trx_stats()</a></code> function.</p>
<div class="section level2">
<h2 id="simulated-transaction-and-account-value-data">Simulated transaction and account value data<a class="anchor" aria-label="anchor" href="#simulated-transaction-and-account-value-data"></a>
</h2>
<p>In this example, we’ll be using the <code>census_dat</code>,
<code>withdrawals</code>, and <code>account_vals</code> data sets. Each
data set is based on a theoretical block of deferred annuity business
with a guaranteed lifetime income benefit.</p>
<ul>
<li>
<code>census_dat</code> contains census-level information with one
row per policy</li>
<li>
<code>withdrawals</code> contains withdrawal transactions. There are
2 types of transactions in the data: “Base” (ordinary withdrawals) and
“Rider” (guaranteed income payments).</li>
<li>
<code>account_vals</code> contains historical account values on
policy anniversaries. This data will be used to calculate withdrawal
rates as a percentage of account values.</li>
</ul>
</div>
<div class="section level2">
<h2 id="the-add_transactions-function">The <code>add_transactions()</code> function<a class="anchor" aria-label="anchor" href="#the-add_transactions-function"></a>
</h2>
<p>The <code><a href="../reference/add_transactions.html">add_transactions()</a></code> function attaches transactions to
a data frame with exposure-level records. This data frame must have the
class <code>exposed_df</code>. For our example, we first need to convert
<code>census_dat</code> into exposure records using the
<code><a href="../reference/expose.html">expose()</a></code> function.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See &lt;code&gt;&lt;a href=&quot;../articles/exposures.html&quot;&gt;vignette('exposures')&lt;/a&gt;&lt;/code&gt; for more
information on creating &lt;code&gt;exposed_df&lt;/code&gt; objects.&lt;/p&gt;"><sup>1</sup></a> This example will use policy year
exposures.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattheaphy/actxps/" class="external-link">actxps</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'actxps'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">exposed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expose.html">expose_py</a></span><span class="op">(</span><span class="va">census_dat</span>, <span class="st">"2019-12-31"</span>, target_status <span class="op">=</span> <span class="st">"Surrender"</span><span class="op">)</span></span>
<span><span class="va">exposed_data</span></span>
<span><span class="co">#&gt; Exposure data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exposure type: policy_year </span></span>
<span><span class="co">#&gt;  Target status: Surrender </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 141,252 × 15</span></span></span>
<span><span class="co">#&gt;    pol_num status issue_date inc_guar qual    age product gender wd_age premium</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 141,242 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: term_date &lt;date&gt;, pol_yr &lt;int&gt;, pol_date_yr &lt;date&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pol_date_yr_end &lt;date&gt;, exposure &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The <code>withdrawals</code> data has 4 columns that are required for
attaching transactions:</p>
<ul>
<li>
<code>pol_num</code>: policy number</li>
<li>
<code>trx_date</code>: transaction date</li>
<li>
<code>trx_type</code>: transaction type</li>
<li>
<code>trx_amt</code>: transaction amount</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">withdrawals</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 160,130 × 4</span></span></span>
<span><span class="co">#&gt;    pol_num trx_date   trx_type trx_amt</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       2 2007-10-05 Base          25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 2009-07-30 Base          12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       2 2010-02-22 Base           7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       2 2010-12-30 Base          52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       2 2012-05-07 Base          41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       2 2013-03-15 Base           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       2 2013-12-06 Base           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       2 2015-05-18 Base           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       2 2016-05-10 Base           8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       2 2017-01-08 Base           2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 160,120 more rows</span></span></span></code></pre></div>
<p>The grain of this data is one row per policy per transaction. The
expectation is that the number of records in the transaction data will
not match the number of rows in the exposure data. That is because
policies could have zero or several transactions in a given exposure
period.</p>
<p>The <code><a href="../reference/add_transactions.html">add_transactions()</a></code> function uses a non-equivalent
join to associate each transaction with a policy number and a date
interval found in the exposure data. Then, transaction counts and
amounts are summarized such that there is one row per exposure period.
In the event there are multiple transaction types found in the data,
separate columns are created for each transaction type.</p>
<p>Using our example, we pass both the exposure and withdrawals data to
<code><a href="../reference/add_transactions.html">add_transactions()</a></code>. The resulting data has the same number
of rows as original exposure data and 4 new columns:</p>
<ul>
<li>
<code>trx_amt_Base</code>: the sum of “Base” withdrawal
transactions</li>
<li>
<code>trx_amt_Rider</code>: the sum of “Rider” withdrawal
transactions</li>
<li>
<code>trx_n_Base</code>: the number of “Base” withdrawal
transactions</li>
<li>
<code>trx_n_Rider</code>: the number of “Rider” withdrawal
transactions</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposed_trx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_transactions.html">add_transactions</a></span><span class="op">(</span><span class="va">exposed_data</span>, <span class="va">withdrawals</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Specifying `multiple = "error"` was deprecated in dplyr 1.1.1.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `relationship = "many-to-one"` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">actxps</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/mattheaphy/actxps/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">exposed_trx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 141,252</span></span>
<span><span class="co">#&gt; Columns: 19</span></span>
<span><span class="co">#&gt; $ pol_num         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …</span></span>
<span><span class="co">#&gt; $ status          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Active, Active, Active, Active, Active, Active, Active…</span></span>
<span><span class="co">#&gt; $ issue_date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2014-12-17, 2014-12-17, 2014-12-17, 2014-12-17, 2014-…</span></span>
<span><span class="co">#&gt; $ inc_guar        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALS…</span></span>
<span><span class="co">#&gt; $ qual            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ age             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56, 56, 56, 56, 56, 56, 71, 71, 71, 71, 71, 71, 71, 71…</span></span>
<span><span class="co">#&gt; $ product         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> b, b, b, b, b, b, a, a, a, a, a, a, a, a, a, a, a, a, …</span></span>
<span><span class="co">#&gt; $ gender          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, …</span></span>
<span><span class="co">#&gt; $ wd_age          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 77, 77, 77, 77, 77, 77, 71, 71, 71, 71, 71, 71, 71, 71…</span></span>
<span><span class="co">#&gt; $ premium         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 370, 370, 370, 370, 370, 370, 708, 708, 708, 708, 708,…</span></span>
<span><span class="co">#&gt; $ term_date       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span><span class="co">#&gt; $ pol_yr          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1…</span></span>
<span><span class="co">#&gt; $ pol_date_yr     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2014-12-17, 2015-12-17, 2016-12-17, 2017-12-17, 2018-…</span></span>
<span><span class="co">#&gt; $ pol_date_yr_end <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2015-12-16, 2016-12-16, 2017-12-16, 2018-12-16, 2019-…</span></span>
<span><span class="co">#&gt; $ exposure        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.00000000, 1.00000000, 1.00000000, 1.00000000, 1.0000…</span></span>
<span><span class="co">#&gt; $ trx_amt_Base    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 25, 12, 7, 52, 41, 1, 2, 2, 8, 2, 44…</span></span>
<span><span class="co">#&gt; $ trx_amt_Rider   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ trx_n_Base      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ trx_n_Rider     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span></code></pre></div>
<p>If we print <code>exposed_trx</code>, we can see that it is still an
<code>exposed_df</code> object, but now it has an additional attribute
for transaction types that have been attached.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposed_trx</span></span>
<span><span class="co">#&gt; Exposure data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exposure type: policy_year </span></span>
<span><span class="co">#&gt;  Target status: Surrender </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31</span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 141,252 × 19</span></span></span>
<span><span class="co">#&gt;    pol_num status issue_date inc_guar qual    age product gender wd_age premium</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 141,242 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: term_date &lt;date&gt;, pol_yr &lt;int&gt;, pol_date_yr &lt;date&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pol_date_yr_end &lt;date&gt;, exposure &lt;dbl&gt;, trx_amt_Base &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   trx_amt_Rider &lt;dbl&gt;, trx_n_Base &lt;dbl&gt;, trx_n_Rider &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-trx_stats-function">The <code>trx_stats()</code> function<a class="anchor" aria-label="anchor" href="#the-trx_stats-function"></a>
</h2>
<p>The actxps package’s workhorse function for summarizing transaction
experience is <code><a href="../reference/trx_stats.html">trx_stats()</a></code>. This function returns a
<code>trx_df</code> object, which is a type of data frame containing
additional attributes about the transaction study.</p>
<p>At a minimum, a <code>trx_df</code> includes the following for each
transaction type (<code>trx_type</code>):</p>
<ul>
<li>The number of transactions (<code>trx_n</code>)</li>
<li>The number of exposure periods with a transaction
(<code>trx_flag</code>)</li>
<li>The sum of transactions (<code>trx_amt</code>)</li>
<li>The total exposure (<code>exposure</code>)</li>
<li>The average transaction amount when a transaction occurs
(<code>avg_trx</code>)</li>
<li>The average transaction amount across all records
(<code>avg_all</code>)</li>
<li>The transaction frequency when a transaction occurs
(<code>trx_freq = trx_n / trx_flag</code>)</li>
<li>The transaction utilization
(<code>trx_util = trx_flag / exposure</code>)</li>
</ul>
<p>Optionally, a <code>trx_df</code> can also include:</p>
<ul>
<li>Any grouping variables attached to the input data</li>
<li>Transaction amounts as a percentage of another value when a
transaction occurs (<code>pct_of_*_w_trx</code>)</li>
<li>Transaction amounts as a percentage of another value across all
records (<code>pct_of_*_all</code>)</li>
</ul>
<p>To use <code><a href="../reference/trx_stats.html">trx_stats()</a></code>, we simply need to pass it an
<code>exposed_df</code> object with transactions attached.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Unlike &lt;code&gt;&lt;a href="../reference/exp_stats.html"&gt;exp_stats()&lt;/a&gt;&lt;/code&gt;,
&lt;code&gt;&lt;a href="../reference/trx_stats.html"&gt;trx_stats()&lt;/a&gt;&lt;/code&gt; requires data to be an &lt;code&gt;exposed_df&lt;/code&gt;
object.&lt;/p&gt;'><sup>2</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="va">exposed_trx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups:  </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq trx_util</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Base     <span style="text-decoration: underline;">60</span>500    <span style="text-decoration: underline;">28</span>224 1<span style="text-decoration: underline;">093</span>899   <span style="text-decoration: underline;">124</span>173    38.8    8.81     2.14    0.227</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rider    <span style="text-decoration: underline;">77</span>321    <span style="text-decoration: underline;">35</span>941 2<span style="text-decoration: underline;">842</span>729   <span style="text-decoration: underline;">124</span>173    79.1   22.9      2.15    0.289</span></span></code></pre></div>
<p>The results show us that we specified no groups, which is why the
output data contains a single row for each transaction type.</p>
<div class="section level3">
<h3 id="grouped-data">Grouped data<a class="anchor" aria-label="anchor" href="#grouped-data"></a>
</h3>
<p>If the data frame passed into <code><a href="../reference/trx_stats.html">trx_stats()</a></code> is grouped
using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code>, the resulting output will contain
one record for each transaction type for each unique group.</p>
<p>In the following, <code>exposed_trx</code> is grouped by the presence
of an income guarantee (<code>inc_guar</code>) before being passed to
<code><a href="../reference/trx_stats.html">trx_stats()</a></code>. This results in four rows because we have two
types of transactions and two distinct values of
<code>inc_guar</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">exposed_trx</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">inc_guar</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups: inc_guar </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 10</span></span></span>
<span><span class="co">#&gt;   inc_guar trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE    Base     <span style="text-decoration: underline;">52</span>939    <span style="text-decoration: underline;">24</span>703  <span style="text-decoration: underline;">952</span>629    <span style="text-decoration: underline;">48</span>938    38.6   19.5      2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> FALSE    Rider        0        0       0    <span style="text-decoration: underline;">48</span>938   <span style="color: #BB0000;">NaN</span>      0      <span style="color: #BB0000;">NaN</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TRUE     Base      <span style="text-decoration: underline;">7</span>561     <span style="text-decoration: underline;">3</span>521  <span style="text-decoration: underline;">141</span>270    <span style="text-decoration: underline;">75</span>235    40.1    1.88     2.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> TRUE     Rider    <span style="text-decoration: underline;">77</span>321    <span style="text-decoration: underline;">35</span>941 2<span style="text-decoration: underline;">842</span>729    <span style="text-decoration: underline;">75</span>235    79.1   37.8      2.15</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: trx_util &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Multiple grouping variables are allowed. Below, policy year
(<code>pol_yr</code>) is added as a second grouping variable.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">exposed_trx</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pol_yr</span>, <span class="va">inc_guar</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups: pol_yr, inc_guar </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 11</span></span></span>
<span><span class="co">#&gt;    pol_yr inc_guar trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1 FALSE    Base      <span style="text-decoration: underline;">6</span>077     <span style="text-decoration: underline;">2</span>881   <span style="text-decoration: underline;">98</span>287     <span style="text-decoration: underline;">7</span>435    34.1   13.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1 FALSE    Rider        0        0       0     <span style="text-decoration: underline;">7</span>435   <span style="color: #BB0000;">NaN</span>      0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1 TRUE     Base      <span style="text-decoration: underline;">1</span>370      633   <span style="text-decoration: underline;">21</span>590    <span style="text-decoration: underline;">11</span>106    34.1    1.94</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1 TRUE     Rider     <span style="text-decoration: underline;">8</span>077     <span style="text-decoration: underline;">3</span>778  <span style="text-decoration: underline;">265</span>312    <span style="text-decoration: underline;">11</span>106    70.2   23.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      2 FALSE    Base      <span style="text-decoration: underline;">6</span>091     <span style="text-decoration: underline;">2</span>863   <span style="text-decoration: underline;">98</span>413     <span style="text-decoration: underline;">6</span>813    34.4   14.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      2 FALSE    Rider        0        0       0     <span style="text-decoration: underline;">6</span>813   <span style="color: #BB0000;">NaN</span>      0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      2 TRUE     Base      <span style="text-decoration: underline;">1</span>183      559   <span style="text-decoration: underline;">18</span>554    <span style="text-decoration: underline;">10</span>158    33.2    1.83</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      2 TRUE     Rider     <span style="text-decoration: underline;">8</span>232     <span style="text-decoration: underline;">3</span>834  <span style="text-decoration: underline;">288</span>114    <span style="text-decoration: underline;">10</span>158    75.1   28.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      3 FALSE    Base      <span style="text-decoration: underline;">6</span>016     <span style="text-decoration: underline;">2</span>813   <span style="text-decoration: underline;">97</span>285     <span style="text-decoration: underline;">6</span>176    34.6   15.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      3 FALSE    Rider        0        0       0     <span style="text-decoration: underline;">6</span>176   <span style="color: #BB0000;">NaN</span>      0   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: trx_freq &lt;dbl&gt;, trx_util &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="expressing-transactions-as-a-percentage-of-another-value">Expressing transactions as a percentage of another value<a class="anchor" aria-label="anchor" href="#expressing-transactions-as-a-percentage-of-another-value"></a>
</h2>
<p>In a transaction study, we often want to express transaction amounts
as a percentage of another value. For example, in a withdrawal study,
withdrawal amounts divided by account values provides a withdrawal rate.
In a study of benefit utilization, transactions can be divided by a
maximum benefit amount to derive a benefit utilization rate. In
addition, actual-to-expected rates can be calculated by dividing
transactions by expected values.</p>
<p>If column names are passed to the <code>percent_of</code> argument of
<code><a href="../reference/trx_stats.html">trx_stats()</a></code>, the output will contain 4 additional columns
for each “percent of” variable:</p>
<ul>
<li>The sum of each “percent of” variable</li>
<li>The sum of each “percent of” variable when a transaction occurs.
These columns include the suffix <code>_w_trx</code>.</li>
<li>Transaction amounts divided by each “percent of” variable
(<code>pct_of_{*}_all</code>)</li>
<li>Transaction amounts divided by each “percent of” variable when a
transaction occurs (<code>pct_of_{*}_w_trx</code>)</li>
</ul>
<p>For our example, let’s assume we’re interested in examining
withdrawal transactions as a percentage of account values, which are
available in the <code>account_vals</code> data frame in the column
<code>av_anniv</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># attach account values data</span></span>
<span><span class="va">exposed_trx_w_av</span> <span class="op">&lt;-</span> <span class="va">exposed_trx</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">account_vals</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pol_num"</span>, <span class="st">"pol_date_yr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trx_res</span> <span class="op">&lt;-</span> <span class="va">exposed_trx_w_av</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pol_yr</span>, <span class="va">inc_guar</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span>percent_of <span class="op">=</span> <span class="st">"av_anniv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">trx_res</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 60</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ pol_yr                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, …</span></span>
<span><span class="co">#&gt; $ inc_guar              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, TRUE, TR…</span></span>
<span><span class="co">#&gt; $ trx_type              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Base", "Rider", "Base", "Rider", "Base", "Rider…</span></span>
<span><span class="co">#&gt; $ trx_n                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6077, 0, 1370, 8077, 6091, 0, 1183, 8232, 6016, …</span></span>
<span><span class="co">#&gt; $ trx_flag              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2881, 0, 633, 3778, 2863, 0, 559, 3834, 2813, 0,…</span></span>
<span><span class="co">#&gt; $ trx_amt               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 98287, 0, 21590, 265312, 98413, 0, 18554, 288114…</span></span>
<span><span class="co">#&gt; $ exposure              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7435, 7435, 11106, 11106, 6813, 6813, 10158, 101…</span></span>
<span><span class="co">#&gt; $ avg_trx               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 34.11558, NaN, 34.10742, 70.22552, 34.37408, NaN…</span></span>
<span><span class="co">#&gt; $ avg_all               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.219502, 0.000000, 1.943994, 23.889069, 14.444…</span></span>
<span><span class="co">#&gt; $ trx_freq              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.109337, NaN, 2.164297, 2.137904, 2.127489, NaN…</span></span>
<span><span class="co">#&gt; $ trx_util              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.38749159, 0.00000000, 0.05699622, 0.34017648, …</span></span>
<span><span class="co">#&gt; $ av_anniv_w_trx        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3875306, 0, 865046, 4982082, 3909786, 0, 797932,…</span></span>
<span><span class="co">#&gt; $ av_anniv              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 9686914, 9686914, 14679001, 14679001, 9218561, 9…</span></span>
<span><span class="co">#&gt; $ pct_of_av_anniv_w_trx <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.02536238, NaN, 0.02495821, 0.05325324, 0.02517…</span></span>
<span><span class="co">#&gt; $ pct_of_av_anniv_all   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.010146369, 0.000000000, 0.001470809, 0.0180742…</span></span></code></pre></div>
<div class="section level3">
<h3 id="autoplot-and-autotable">
<code>autoplot()</code> and <code>autotable()</code><a class="anchor" aria-label="anchor" href="#autoplot-and-autotable"></a>
</h3>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> and <code><a href="../reference/autotable.html">autotable()</a></code> functions
can be used to create visualizations and summary tables from
<code>trx_df</code> objects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#eb15e4"</span>, <span class="st">"#7515eb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trx_res</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># remove periods with zero transactions</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trx_n</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pct_of_av_anniv_w_trx</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">.colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Observed Withdrawal Rates by Policy Year and Income Guarantee Presence"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transactions_files/figure-html/trx-plot-1.png" width="2916.66666666667"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trx_res</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># remove periods with zero transactions</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trx_n</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/autotable.html">autotable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<center>
<img src="../reference/figures/trx_gt.png" width="65%" height="65%">
</center>
</div>
</div>
<div class="section level2">
<h2 id="miscellaneous">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous"></a>
</h2>
<div class="section level3">
<h3 id="selecting-and-combining-transaction-types">Selecting and combining transaction types<a class="anchor" aria-label="anchor" href="#selecting-and-combining-transaction-types"></a>
</h3>
<p>The <code>trx_types</code> argument of <code><a href="../reference/trx_stats.html">trx_stats()</a></code> can
be used to select a subset of transaction types that will appear in the
output.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="va">exposed_trx</span>, trx_types <span class="op">=</span> <span class="st">"Base"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups:  </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;   trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq trx_util</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Base     <span style="text-decoration: underline;">60</span>500    <span style="text-decoration: underline;">28</span>224 1<span style="text-decoration: underline;">093</span>899   <span style="text-decoration: underline;">124</span>173    38.8    8.81     2.14    0.227</span></span></code></pre></div>
<p>If the <code>combine_trx</code> argument is set to <code>TRUE</code>,
all transaction types will be combined in a group called “All” in the
output.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="va">exposed_trx</span>, combine_trx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups:  </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;   trx_type  trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq trx_util</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> All      <span style="text-decoration: underline;">137</span>821    <span style="text-decoration: underline;">64</span>165 3<span style="text-decoration: underline;">936</span>628   <span style="text-decoration: underline;">124</span>173    61.4    31.7     2.15    0.517</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="partial-exposures-are-removed-as-a-default">Partial exposures are removed as a default<a class="anchor" aria-label="anchor" href="#partial-exposures-are-removed-as-a-default"></a>
</h3>
<p>As a default, <code><a href="../reference/trx_stats.html">trx_stats()</a></code> removes partial exposures
before summarizing results. This is done to avoid complexity associated
with a lopsided skew in the timing of transactions. For example, if
transactions can occur on a monthly basis or annually at the beginning
of each policy year, partial exposures may not be appropriate. If a
policy had an exposure of 0.5 years and was taking withdrawals annually
at the beginning of the year, an argument could be made that the
exposure should instead be 1 complete year. If the same policy was
expected to take withdrawals 9 months into the year, it’s not clear if
the exposure should be 0.5 years or 0.5 / 0.75 years. To override this
treatment, set the <code>full_exposures_only</code> argument to
<code>FALSE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trx_stats.html">trx_stats</a></span><span class="op">(</span><span class="va">exposed_trx</span>, full_exposures_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups:  </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq trx_util</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Base     <span style="text-decoration: underline;">69</span>430    <span style="text-decoration: underline;">32</span>379 1<span style="text-decoration: underline;">271</span>778  <span style="text-decoration: underline;">132</span>634.    39.3    9.59     2.14    0.244</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rider    <span style="text-decoration: underline;">90</span>700    <span style="text-decoration: underline;">42</span>139 3<span style="text-decoration: underline;">361</span>541  <span style="text-decoration: underline;">132</span>634.    79.8   25.3      2.15    0.318</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary-method">Summary method<a class="anchor" aria-label="anchor" href="#summary-method"></a>
</h3>
<p>As noted above, the result of <code><a href="../reference/trx_stats.html">trx_stats()</a></code> is a
<code>trx_df</code> object. If the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function is
applied to a <code>trx_df</code> object, the data will be summarized
again and return a higher level <code>trx_df</code> object.</p>
<p>If no additional arguments are passed, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> returns
a single row of aggregate results for each transaction type.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trx_res</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups:  </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt;  Transactions as % of: av_anniv </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 13</span></span></span>
<span><span class="co">#&gt;   trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq trx_util</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Base     <span style="text-decoration: underline;">60</span>500    <span style="text-decoration: underline;">28</span>224 1<span style="text-decoration: underline;">093</span>899   <span style="text-decoration: underline;">124</span>173    38.8    8.81     2.14    0.227</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rider    <span style="text-decoration: underline;">77</span>321    <span style="text-decoration: underline;">35</span>941 2<span style="text-decoration: underline;">842</span>729   <span style="text-decoration: underline;">124</span>173    79.1   22.9      2.15    0.289</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: av_anniv_w_trx &lt;dbl&gt;, av_anniv &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pct_of_av_anniv_w_trx &lt;dbl&gt;, pct_of_av_anniv_all &lt;dbl&gt;</span></span></span></code></pre></div>
<p>If additional variable names are passed to the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function, then the output will group the data by those variables. In our
example, if <code>pol_yr</code> is passed to <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, the
output will contain one row per policy year for each transaction
type.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trx_res</span>, <span class="va">pol_yr</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups: pol_yr </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt;  Transactions as % of: av_anniv </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 14</span></span></span>
<span><span class="co">#&gt;    pol_yr trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1 Base      <span style="text-decoration: underline;">7</span>447     <span style="text-decoration: underline;">3</span>514  <span style="text-decoration: underline;">119</span>877    <span style="text-decoration: underline;">18</span>541    34.1    6.47     2.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1 Rider     <span style="text-decoration: underline;">8</span>077     <span style="text-decoration: underline;">3</span>778  <span style="text-decoration: underline;">265</span>312    <span style="text-decoration: underline;">18</span>541    70.2   14.3      2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      2 Base      <span style="text-decoration: underline;">7</span>274     <span style="text-decoration: underline;">3</span>422  <span style="text-decoration: underline;">116</span>967    <span style="text-decoration: underline;">16</span>971    34.2    6.89     2.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      2 Rider     <span style="text-decoration: underline;">8</span>232     <span style="text-decoration: underline;">3</span>834  <span style="text-decoration: underline;">288</span>114    <span style="text-decoration: underline;">16</span>971    75.1   17.0      2.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      3 Base      <span style="text-decoration: underline;">7</span>061     <span style="text-decoration: underline;">3</span>309  <span style="text-decoration: underline;">116</span>357    <span style="text-decoration: underline;">15</span>397    35.2    7.56     2.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      3 Rider     <span style="text-decoration: underline;">8</span>204     <span style="text-decoration: underline;">3</span>817  <span style="text-decoration: underline;">294</span>795    <span style="text-decoration: underline;">15</span>397    77.2   19.1      2.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      4 Base      <span style="text-decoration: underline;">6</span>596     <span style="text-decoration: underline;">3</span>080  <span style="text-decoration: underline;">114</span>987    <span style="text-decoration: underline;">13</span>790    37.3    8.34     2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      4 Rider     <span style="text-decoration: underline;">7</span>960     <span style="text-decoration: underline;">3</span>715  <span style="text-decoration: underline;">283</span>763    <span style="text-decoration: underline;">13</span>790    76.4   20.6      2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      5 Base      <span style="text-decoration: underline;">6</span>093     <span style="text-decoration: underline;">2</span>847  <span style="text-decoration: underline;">109</span>918    <span style="text-decoration: underline;">12</span>234    38.6    8.98     2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      5 Rider     <span style="text-decoration: underline;">7</span>536     <span style="text-decoration: underline;">3</span>521  <span style="text-decoration: underline;">264</span>939    <span style="text-decoration: underline;">12</span>234    75.2   21.7      2.14</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: trx_util &lt;dbl&gt;, av_anniv_w_trx &lt;dbl&gt;, av_anniv &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pct_of_av_anniv_w_trx &lt;dbl&gt;, pct_of_av_anniv_all &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Similarly, if <code>inc_guar</code> is passed to
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, the output will contain a row for each
transaction type and unique value in <code>inc_guar</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trx_res</span>, <span class="va">inc_guar</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transaction study results</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Groups: inc_guar </span></span>
<span><span class="co">#&gt;  Study range: 1900-01-01 to 2019-12-31 </span></span>
<span><span class="co">#&gt;  Transaction types: Base, Rider </span></span>
<span><span class="co">#&gt;  Transactions as % of: av_anniv </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 14</span></span></span>
<span><span class="co">#&gt;   inc_guar trx_type trx_n trx_flag trx_amt exposure avg_trx avg_all trx_freq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE    Base     <span style="text-decoration: underline;">52</span>939    <span style="text-decoration: underline;">24</span>703  <span style="text-decoration: underline;">952</span>629    <span style="text-decoration: underline;">48</span>938    38.6   19.5      2.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> FALSE    Rider        0        0       0    <span style="text-decoration: underline;">48</span>938   <span style="color: #BB0000;">NaN</span>      0      <span style="color: #BB0000;">NaN</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TRUE     Base      <span style="text-decoration: underline;">7</span>561     <span style="text-decoration: underline;">3</span>521  <span style="text-decoration: underline;">141</span>270    <span style="text-decoration: underline;">75</span>235    40.1    1.88     2.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> TRUE     Rider    <span style="text-decoration: underline;">77</span>321    <span style="text-decoration: underline;">35</span>941 2<span style="text-decoration: underline;">842</span>729    <span style="text-decoration: underline;">75</span>235    79.1   37.8      2.15</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: trx_util &lt;dbl&gt;, av_anniv_w_trx &lt;dbl&gt;, av_anniv &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pct_of_av_anniv_w_trx &lt;dbl&gt;, pct_of_av_anniv_all &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="column-names">Column names<a class="anchor" aria-label="anchor" href="#column-names"></a>
</h3>
<p>As a default, <code><a href="../reference/add_transactions.html">add_transactions()</a></code> assumes the transaction
data frame (<code>trx_data</code>) uses the following naming
conventions:</p>
<ul>
<li>The policy number column is called <code>pol_num</code>
</li>
<li>The transaction date column is called <code>trx_date</code>
</li>
<li>The transaction type column is called <code>trx_type</code>
</li>
<li>The transaction amount column is called <code>trx_amt</code>
</li>
</ul>
<p>These default names can be overridden using the
<code>col_pol_num</code>, <code>col_trx_date</code>,
<code>col_trx_type</code>, and <code>col_trx_amt</code> arguments.</p>
<p>For example, if the transaction type column was called
<code>transaction_code</code> in our data, we could write:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposed_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_transactions.html">add_transactions</a></span><span class="op">(</span><span class="va">withdrawals</span>, col_trx_type <span class="op">=</span> <span class="st">"transaction_code"</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, <code><a href="../reference/trx_stats.html">trx_stats()</a></code> assumes the input data uses the
name <code>exposure</code> for exposures. This default can be overridden
using the argument <code>col_exposure</code>.</p>
</div>
<div class="section level3">
<h3 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h3>
<p>The <code><a href="../reference/trx_stats.html">trx_stats()</a></code> function does not produce any
calculations related to the persistence of transactions from exposure
period to exposure period.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Heaphy.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7. Logo <a href="https://www.freepik.com/free-vector/shine-old-wooden-chest-realistic-composition-transparent-background-with-vintage-coffer-sparkling-particles_7497397.htm#query=treasure&amp;position=7&amp;from_view=search&amp;track=sph" class="external-link">image by macrovector</a> on Freepik</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
