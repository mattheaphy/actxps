<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interactively explore experience data — exp_shiny • actxps</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interactively explore experience data — exp_shiny"><meta name="description" content='Launch a Shiny application to interactively explore drivers of
experience.
dat must be an exposed_df object. An error will be thrown is any other
object type is passed. If dat has transactions attached, the app will
contain features for both termination and transaction studies. Otherwise,
the app will only support termination studies.
If nothing is passed to predictors, all columns names in dat will be
used (excluding the policy number, status, termination date, exposure,
transaction counts, and transaction amounts columns).
The expected argument is optional. As a default, any column names
containing the word "expected" are used.'><meta property="og:description" content='Launch a Shiny application to interactively explore drivers of
experience.
dat must be an exposed_df object. An error will be thrown is any other
object type is passed. If dat has transactions attached, the app will
contain features for both termination and transaction studies. Otherwise,
the app will only support termination studies.
If nothing is passed to predictors, all columns names in dat will be
used (excluding the policy number, status, termination date, exposure,
transaction counts, and transaction amounts columns).
The expected argument is optional. As a default, any column names
containing the word "expected" are used.'><meta property="og:image" content="https://mattheaphy.github.io/actxps/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">actxps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/actxps.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/exposures.html">Exposure calculations</a></li>
    <li><a class="dropdown-item" href="../articles/exp_summary.html">Experience summaries</a></li>
    <li><a class="dropdown-item" href="../articles/transactions.html">Transaction studies</a></li>
    <li><a class="dropdown-item" href="../articles/visualizations.html">Data visualizations</a></li>
    <li><a class="dropdown-item" href="../articles/misc.html">Other functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mattheaphy/actxps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interactively explore experience data</h1>
      <small class="dont-index">Source: <a href="https://github.com/mattheaphy/actxps/blob/main/R/exp_shiny.R" class="external-link"><code>R/exp_shiny.R</code></a></small>
      <div class="d-none name"><code>exp_shiny.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Launch a Shiny application to interactively explore drivers of
experience.</p>
<p><code>dat</code> must be an <code>exposed_df</code> object. An error will be thrown is any other
object type is passed. If <code>dat</code> has transactions attached, the app will
contain features for both termination and transaction studies. Otherwise,
the app will only support termination studies.</p>
<p>If nothing is passed to <code>predictors</code>, all columns names in <code>dat</code> will be
used (excluding the policy number, status, termination date, exposure,
transaction counts, and transaction amounts columns).</p>
<p>The <code>expected</code> argument is optional. As a default, any column names
containing the word "expected" are used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">exp_shiny</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,</span>
<span>  expected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"expected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  distinct_max <span class="op">=</span> <span class="fl">25L</span>,</span>
<span>  <span class="va">title</span>,</span>
<span>  credibility <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  cred_r <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  theme <span class="op">=</span> <span class="st">"shiny"</span>,</span>
<span>  col_exposure <span class="op">=</span> <span class="st">"exposure"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>An <code>exposed_df</code> object.</p></dd>


<dt id="arg-predictors">predictors<a class="anchor" aria-label="anchor" href="#arg-predictors"></a></dt>
<dd><p>A character vector of independent variables in <code>dat</code> to
include in the Shiny app.</p></dd>


<dt id="arg-expected">expected<a class="anchor" aria-label="anchor" href="#arg-expected"></a></dt>
<dd><p>A character vector of expected values in <code>dat</code> to include
in the Shiny app.</p></dd>


<dt id="arg-distinct-max">distinct_max<a class="anchor" aria-label="anchor" href="#arg-distinct-max"></a></dt>
<dd><p>Maximum number of distinct values allowed for
<code>predictors</code> to be included as "Color" and "Facets" grouping variables. This
input prevents the drawing of overly complex plots. Default value = 25.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Optional. Title of the Shiny app. If no title is provided,
a descriptive title will be generated based on attributes of <code>dat</code>.</p></dd>


<dt id="arg-credibility">credibility<a class="anchor" aria-label="anchor" href="#arg-credibility"></a></dt>
<dd><p>If <code>TRUE</code>, the output will include partial credibility
weights and credibility-weighted termination rates.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level used for the Limited Fluctuation
credibility method and confidence intervals</p></dd>


<dt id="arg-cred-r">cred_r<a class="anchor" aria-label="anchor" href="#arg-cred-r"></a></dt>
<dd><p>Error tolerance under the Limited Fluctuation credibility
method</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>The name of a theme passed to the <code>preset</code> argument of
<code><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bslib::bs_theme()</a></code>. Alternatively, a complete Bootstrap theme created using
<code><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bslib::bs_theme()</a></code>.</p></dd>


<dt id="arg-col-exposure">col_exposure<a class="anchor" aria-label="anchor" href="#arg-col-exposure"></a></dt>
<dd><p>Name of the column in <code>dat</code> containing exposures. This
input is only used to clarify the exposure basis when <code>dat</code> is a
<code>split_exposed_df</code> object. For more information on split exposures, see
<code><a href="expose_split.html">expose_split()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>No return value. This function is called for the side effect of
launching a Shiny application.</p>
    </div>
    <div class="section level2">
    <h2 id="layout">Layout<a class="anchor" aria-label="anchor" href="#layout"></a></h2>

<div class="section">
<h3 id="filters">Filters<a class="anchor" aria-label="anchor" href="#filters"></a></h3>


<p>The sidebar contains filtering widgets organized by data type for all
variables passed to the <code>predictors</code> argument.</p>
<p>At the top of the sidebar, information is shown on the percentage of records
remaining after applying filters. A description of all active filters is also
provided.</p>
<p>The top of the sidebar also includes a "play / pause" switch that can pause
reactivity of the application. Pausing is a good option when multiple changes
are made in quick succession, especially when the underlying data set is
large.</p>
</div>

<div class="section">
<h3 id="grouping-variables">Grouping variables<a class="anchor" aria-label="anchor" href="#grouping-variables"></a></h3>


<p>This box includes widgets to select grouping variables for summarizing
experience. The "x" widget determines the x variable in the plot output.
Similarly, the "Color" and "Facets" widgets are used for color and facets.
Multiple faceting variable selections are allowed. For the table output,
"x", "Color", and "Facets" have no particular meaning beyond the order in
which grouping variables are displayed.</p>
</div>

<div class="section">
<h3 id="study-type">Study type<a class="anchor" aria-label="anchor" href="#study-type"></a></h3>


<p>This box includes a toggle to switch between termination studies and
transaction studies (if available). Different options are available for each
study type.</p><div class="section">
<h4 id="termination-studies">Termination studies<a class="anchor" aria-label="anchor" href="#termination-studies"></a></h4>


<p>The expected values checkboxes are used to activate and deactivate expected
values passed to the <code>expected</code> argument. These checkboxes also include a
a "control" item for expected values derived using control variables.
These boxes impact the table output directly and the available "y" variables
for the plot. The "Weight by" widget is used to specify which column, if any,
contains weights for summarizing experience. The "Control variables" widget
is used to specify which columns, if any, are used as control variables (
see <code><a href="exp_stats.html">exp_stats()</a></code> for more information).</p>
</div>

<div class="section">
<h4 id="transaction-studies">Transaction studies<a class="anchor" aria-label="anchor" href="#transaction-studies"></a></h4>


<p>The transaction types checkboxes are used to activate and deactivate
transaction types that appear in the plot and table outputs. The available
transaction types are taken from the <code>trx_types</code> attribute of <code>dat</code>.
In the plot output, transaction type will always appear as a faceting
variable. The "Transactions as % of" selector will expand the list of
available "y" variables for the plot and impact the table output directly.
Lastly, a toggle exists that allows for all transaction types to be
aggregated into a single group.</p>
</div>


</div>

<div class="section">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a></h3>

<div class="section">
<h4 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a></h4>


<p>This tab includes a plot and various options for customization:</p><ul><li><p>y: y variable</p></li>
<li><p>Geometry: plotting geometry</p></li>
<li><p>Second y-axis: activate to enable a second y-axis</p></li>
<li><p>Second axis y: y variable to plot on the second axis</p></li>
<li><p>Add Smoothing: activate to plot loess curves</p></li>
<li><p>Confidence intervals: If available, add error bars for confidence intervals
around the selected y variable</p></li>
<li><p>Free y Scales: activate to enable separate y scales in each plot</p></li>
<li><p>Log y-axis: activate to plot all y-axes on a log-10 scale</p></li>
</ul><p>The gear icon above the plot contains a pop-up menu that can be used to
change the size of the plot for exporting.</p>
</div>

<div class="section">
<h4 id="table">Table<a class="anchor" aria-label="anchor" href="#table"></a></h4>


<p>This tab includes a data table.</p>
<p>The gear icon above the table contains a pop-up menu that can be used to
change the appearance of the table:</p><ul><li><p>The "Total row", "Confidence intervals", and "Credibility-weighted
termination rates" switches add these outputs to the table. These values are
hidden as a default to prevent over-crowding.</p></li>
<li><p>The "Include color scales" switch disables or re-enables conditional color
formatting.</p></li>
<li><p>The "Decimals" slider controls the number of decimals displayed for
percentage fields.</p></li>
<li><p>The "Font size multiple" slider impacts the table's font size</p></li>
</ul></div>

<div class="section">
<h4 id="export">Export<a class="anchor" aria-label="anchor" href="#export"></a></h4>


<p>This pop-up menu contains options for saving summarized experience data, the
plot, or the table. Data is saved as a CSV file. The plot and table are saved
as png files.</p>
</div>


</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">study_py</span> <span class="op">&lt;-</span> <span class="fu"><a href="expose.html">expose_py</a></span><span class="op">(</span><span class="va">census_dat</span>, <span class="st">"2019-12-31"</span>, target_status <span class="op">=</span> <span class="st">"Surrender"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">expected_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.03</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">study_py</span> <span class="op">&lt;-</span> <span class="va">study_py</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>expected_1 <span class="op">=</span> <span class="va">expected_table</span><span class="op">[</span><span class="va">pol_yr</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>           expected_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">inc_guar</span>, <span class="fl">0.015</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="add_transactions.html">add_transactions</a></span><span class="op">(</span><span class="va">withdrawals</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">account_vals</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pol_num"</span>, <span class="st">"pol_date_yr"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">exp_shiny</span><span class="op">(</span><span class="va">study_py</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Heaphy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Logo <a href="https://www.freepik.com/free-vector/shine-old-wooden-chest-realistic-composition-transparent-background-with-vintage-coffer-sparkling-particles_7497397.htm#query=treasure&amp;position=7&amp;from_view=search&amp;track=sph" class="external-link">image by macrovector</a> on Freepik</p>
</div>

    </footer></div>





  </body></html>

