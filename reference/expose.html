<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create exposure records from census records — expose • actxps</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create exposure records from census records — expose"><meta name="description" content="Convert a data frame of census-level records to exposure-level
records."><meta property="og:description" content="Convert a data frame of census-level records to exposure-level
records."><meta property="og:image" content="https://mattheaphy.github.io/actxps/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">actxps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/actxps.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/exposures.html">Exposure calculations</a></li>
    <li><a class="dropdown-item" href="../articles/exp_summary.html">Experience summaries</a></li>
    <li><a class="dropdown-item" href="../articles/transactions.html">Transaction studies</a></li>
    <li><a class="dropdown-item" href="../articles/visualizations.html">Data visualizations</a></li>
    <li><a class="dropdown-item" href="../articles/misc.html">Other functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mattheaphy/actxps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create exposure records from census records</h1>
      <small class="dont-index">Source: <a href="https://github.com/mattheaphy/actxps/blob/main/R/expose.R" class="external-link"><code>R/expose.R</code></a></small>
      <div class="d-none name"><code>expose.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Convert a data frame of census-level records to exposure-level
records.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">expose</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">end_date</span>,</span>
<span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1900-01-01"</span><span class="op">)</span>,</span>
<span>  target_status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cal_expo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  expo_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"quarter"</span>, <span class="st">"month"</span>, <span class="st">"week"</span><span class="op">)</span>,</span>
<span>  col_pol_num <span class="op">=</span> <span class="st">"pol_num"</span>,</span>
<span>  col_status <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  col_issue_date <span class="op">=</span> <span class="st">"issue_date"</span>,</span>
<span>  col_term_date <span class="op">=</span> <span class="st">"term_date"</span>,</span>
<span>  <span class="va">default_status</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_py</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_pq</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_pm</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_pw</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_cy</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_cq</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_cm</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">expose_cw</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame with census-level records</p></dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a></dt>
<dd><p>Experience study end date</p></dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a></dt>
<dd><p>Experience study start date. Default value = 1900-01-01.</p></dd>


<dt id="arg-target-status">target_status<a class="anchor" aria-label="anchor" href="#arg-target-status"></a></dt>
<dd><p>Character vector of target status values. Default value
= <code>NULL</code>.</p></dd>


<dt id="arg-cal-expo">cal_expo<a class="anchor" aria-label="anchor" href="#arg-cal-expo"></a></dt>
<dd><p>Set to TRUE for calendar year exposures. Otherwise policy
year exposures are assumed.</p></dd>


<dt id="arg-expo-length">expo_length<a class="anchor" aria-label="anchor" href="#arg-expo-length"></a></dt>
<dd><p>Exposure period length</p></dd>


<dt id="arg-col-pol-num">col_pol_num<a class="anchor" aria-label="anchor" href="#arg-col-pol-num"></a></dt>
<dd><p>Name of the column in <code>.data</code> containing the policy number</p></dd>


<dt id="arg-col-status">col_status<a class="anchor" aria-label="anchor" href="#arg-col-status"></a></dt>
<dd><p>Name of the column in <code>.data</code> containing the policy status</p></dd>


<dt id="arg-col-issue-date">col_issue_date<a class="anchor" aria-label="anchor" href="#arg-col-issue-date"></a></dt>
<dd><p>Name of the column in <code>.data</code> containing the issue date</p></dd>


<dt id="arg-col-term-date">col_term_date<a class="anchor" aria-label="anchor" href="#arg-col-term-date"></a></dt>
<dd><p>Name of the column in <code>.data</code> containing the termination
date</p></dd>


<dt id="arg-default-status">default_status<a class="anchor" aria-label="anchor" href="#arg-default-status"></a></dt>
<dd><p>Optional scalar character representing the default
active status code. If not provided, the most common status is assumed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code>expose()</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with class <code>exposed_df</code>, <code>tbl_df</code>, <code>tbl</code>,
and <code>data.frame</code>. The results include all existing columns in
<code>.data</code> plus new columns for exposures and observation periods. Observation
periods include counters for policy exposures, start dates, and end dates.
Both start dates and end dates are inclusive bounds.</p>
<p>For policy year exposures, two observation period columns are returned.
Columns beginning with (<code>pol_</code>) are integer policy periods. Columns
beginning with (<code>pol_date_</code>) are calendar dates representing
anniversary dates, monthiversary dates, etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Census-level data refers to a data set wherein there is one row
per unique policy. Exposure-level data expands census-level data such that
there is one record per policy per observation period. Observation periods
could be any meaningful period of time such as a policy year, policy month,
calendar year, calendar quarter, calendar month, etc.</p>
<p><code>target_status</code> is used in the calculation of exposures. The annual
exposure method is applied, which allocates a full period of exposure for
any statuses in <code>target_status</code>. For all other statuses, new entrants
and exits are partially exposed based on the time elapsed in the observation
period. This method is consistent with the Balducci Hypothesis, which assumes
that the probability of termination is proportionate to the time elapsed
in the observation period. If the annual exposure method isn't desired,
<code>target_status</code> can be ignored. In this case, partial exposures are
always applied regardless of status.</p>
<p><code>default_status</code> is used to indicate the default active status that
should be used when exposure records are created.</p>
    </div>
    <div class="section level2">
    <h2 id="policy-period-and-calendar-period-variations">Policy period and calendar period variations<a class="anchor" aria-label="anchor" href="#policy-period-and-calendar-period-variations"></a></h2>
    <p>The functions <code>expose_py()</code>, <code>expose_pq()</code>, <code>expose_pm()</code>,
<code>expose_pw()</code>, <code>expose_cy()</code>, <code>expose_cq()</code>,
<code>expose_cm()</code>, <code>expose_cw()</code> are convenience functions for
specific implementations of <code>expose()</code>. The two characters after the
underscore describe the exposure type and exposure period, respectively.</p>
<p>For exposures types:</p><ul><li><p><code>p</code> refers to policy years</p></li>
<li><p><code>c</code> refers to calendar years</p></li>
</ul><p>For exposure periods:</p><ul><li><p><code>y</code> = years</p></li>
<li><p><code>q</code> = quarters</p></li>
<li><p><code>m</code> = months</p></li>
<li><p><code>w</code> = weeks</p></li>
</ul><p>All columns containing dates must be in YYYY-MM-DD format.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Atkinson and McGarry (2016). Experience Study Calculations.
<a href="https://www.soa.org/49378a/globalassets/assets/files/research/experience-study-calculations.pdf" class="external-link">https://www.soa.org/49378a/globalassets/assets/files/research/experience-study-calculations.pdf</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="expose_split.html">expose_split()</a></code> for information on splitting calendar year
exposures by policy year.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">toy_census</span> <span class="op">|&gt;</span> <span class="fu">expose</span><span class="op">(</span><span class="st">"2020-12-31"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Exposure data</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Exposure type</span>: policy_year</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Target status</span>:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Study range</span>: 1900-01-01 to 2020-12-31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 33 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pol_num status issue_date term_date pol_yr pol_date_yr pol_date_yr_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             1 2010-01-01  2010-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             2 2011-01-01  2011-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             3 2012-01-01  2012-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             4 2013-01-01  2013-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             5 2014-01-01  2014-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             6 2015-01-01  2015-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             7 2016-01-01  2016-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             8 2017-01-01  2017-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>             9 2018-01-01  2018-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>       1 Active 2010-01-01 <span style="color: #BB0000;">NA</span>            10 2019-01-01  2019-12-31     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 23 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: exposure &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">census_dat</span> <span class="op">|&gt;</span> <span class="fu">expose_py</span><span class="op">(</span><span class="st">"2019-12-31"</span>, target_status <span class="op">=</span> <span class="st">"Surrender"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Exposure data</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Exposure type</span>: policy_year</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Target status</span>: Surrender</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #00BB00;">Study range</span>: 1900-01-01 to 2019-12-31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 141,252 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pol_num status issue_date inc_guar qual    age product gender wd_age premium</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>       1 Active 2014-12-17 TRUE     FALSE    56 b       F          77     370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>       2 Active 2007-09-24 FALSE    FALSE    71 a       F          71     708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 141,242 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5 more variables: term_date &lt;date&gt;, pol_yr &lt;int&gt;, pol_date_yr &lt;date&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pol_date_yr_end &lt;date&gt;, exposure &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Heaphy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Logo <a href="https://www.freepik.com/free-vector/shine-old-wooden-chest-realistic-composition-transparent-background-with-vintage-coffer-sparkling-particles_7497397.htm#query=treasure&amp;position=7&amp;from_view=search&amp;track=sph" class="external-link">image by macrovector</a> on Freepik</p>
</div>

    </footer></div>





  </body></html>

